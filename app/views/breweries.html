
<script>
	$( window ).resize(function() {
		var h = $(window).height();
		var w = $(window).width();

		var newH = h - 100;
		if (w > 720) {
			$('#vancouverMap').css({
		        height: newH
		    });
		    $('.angular-google-map-container').css({
		        height: newH + 30
		    });
		} else {
			$('#vancouverMap').css({
		        height: h
		    });
		    $('.angular-google-map-container').css({
		        height: h + 30
		    });
		}
	});
	
	$(window).scroll(function(){
        var w = $(window).width();
        beerTop = $("#brewerResults").offset().top - $(window).scrollTop();
        if (w < 720) {
        	if (beerTop < ($(window).height() / 2)) {
        		$('#fab').addClass('mapIcon');
        	} else {
        		$('#fab').removeClass('mapIcon');
        	}
        } else {
        	$('#fab').removeClass('mapIcon');
        }
	});

   	$(window).scroll(function(){

		var scrollTop = $(window).scrollTop();

        var w = $(window).width();

        if ($('#brewerResults').length){
	        beerTop = $("#brewerResults").offset().top - $(window).scrollTop();
	        if (w < 720) {
	        	if (beerTop < ($(window).height() / 2)) {
	        		$('#fab').addClass('mapIcon');
	        	} else {
	        		$('#fab').removeClass('mapIcon');
	        	}
	        } else {
	        	$('#fab').removeClass('mapIcon');
	        }
	    }

        if ($('#detailContent').length){
	        contentTop = $("#detailContent").offset().top - scrollTop;
	    	if (contentTop < 80) {
	    		$('header').removeClass('detail-view');
	    	} else {
	    		$('header').addClass('detail-view');
	    	}
			
			var newOpacity = 1 - $(window).scrollTop() / 300;
	        $(".shadow").css({
	            opacity: newOpacity
	        });   
	        $(".heroImage").css({
	            opacity: newOpacity
	        });   		
	    }
   });

	$('#fab').click(function() {
		var w = $(window).width();
		beerTop = $("#brewerResults").offset().top - $(window).scrollTop();
		if (w < 720) {	
			if (beerTop < ($(window).height() / 2)) {
				$('html, body').animate({
			        scrollTop: 0
			    }, 500);
			} else {
				$('html, body').animate({
		        	scrollTop: $('#brewerResults').offset().top - 64
		    	}, 500);
			}
		} else {
			$('html, body').animate({
		        scrollTop: $('#brewerResults').offset().top - 64
		    }, 500);
		}
	    return false;
	});

	$('#filterBtn').click(function() {
		$('#filter-panel').toggleClass("open");
		$('#vancouverMap').toggleClass("makeSpaceForFilter");
		$('#brewerResults').toggleClass("makeSpaceForFilter");
	});

	$('#search').bind('input', function() { 
	 	$('html, body').animate({
        	scrollTop: $('#brewerResults').offset().top - 64
    	}, 500);
	});
	$('#menuBtn').click(function() {
		if ( menuhidden == false ) {
			$( menu ).animate({left: "-=250"}, 250);
			menuhidden = true;
		} else if ( menuhidden == true ) {
			$( menu ).animate({left: "+=250"}, 250);
			menuhidden = false;
		}
	});
</script>

<div ng-controller="BreweryListController" ng-app="breweryListApp">
	<header class="main">
		<button class="menuBtn" id="menuBtn">
			<img src="images/icons/menu_white.svg" class="nav_icon mobile">
		</button>
		<div class="navTitleMobile mobile">
			<span>Breweries</span>
		</div>
		<div class="navDesktop desktop">
			<a href="#/breweries" class="selected">Breweries</a>
			<a href="#/beers">Beers</a>
		</div>

		<div class="searchbox">
			<span class="searchicon"></span>
			<input ng-model="query" class="unstyled" id="search">
		</div>

		<button class="filterBtn" id="filterBtn">
			<img src="images/icons/filter_white.svg" class="nav_icon">
			<span>Filter</span>
		</button>
	</header>

	<div id="filter-panel">
		filter options... coming soon.
	</div>

	<div id="vancouverMap" >
		<div class="map-container">
			<ui-gmap-google-map center='map.center' zoom='map.zoom'options='map.options'>
				<ui-gmap-marker ng-repeat="marker in markers"
					coords="marker.coords" 
					options="marker.options" 
					events="marker.events" 
					idkey="marker.id"
					click="marker.click"
					icon="marker.icon">
			</ui-gmap-google-map>
		</div>
		<a id="fab" class="fab-btn btn-next"></a>
	</div>

	<section id="brewerResults" class="pushBelowHeader">
		<div class="container">
			<p>Order: 
				<select ng-model="orderProp">
					<option value="name">Alphabetical</option>
					<option value="">Most Beers</option>
					<option value="">Least Beers</option>
				</select>
			</p>
			<span class="line"></span>
			<div class="row" ng-repeat="brewery in breweries | filter:query | orderBy:orderProp">
				<a href="#/breweries/{{brewery.id}}">
					<div class="beerListInfo col-xs-12">
						<h3>{{brewery.name}}</h3>
						<p>{{brewery.address}}</p>
					</div>
				</a>
			</div>
		</div>


		<my-directive x-user-defined-function="whenSuccessFunction(data)"></my-directive>

	</section>
</div>